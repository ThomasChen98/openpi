100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 300/300 [26:08<00:00,  5.23s/it]
00:11:52.676 [I] Waiting for checkpoint manager to finish                                         (268286:train_auto.py:346)
00:11:52.676 [I] [process=0][thread=MainThread][step=299][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (268286:checkpoint_manager.py:1998)
00:11:52.694 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 25.2 MiB/s (total bytes: 12.5 GiB) (time elapsed: 8 minutes) (per-host) (268286:base_pytree_checkpoint_handler.py:114)
00:11:52.898 [I] [process=0][thread=array_type_handler] Wrote 156 array_metadata.ArrayMetadata to /mnt/ssd1/yuxin/openpi/checkpoints/pi05_h1_auto/e2e_lift_lid/epoch_0/299.orbax-checkpoint-tmp-0/train_state.orbax-checkpoint-tmp-3/array_metadatas/process_0 (268286:array_metadata_store.py:198)
00:12:07.547 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 73.6 MiB/s (total bytes: 37.5 GiB) (time elapsed: 8 minutes) (per-host) (268286:base_pytree_checkpoint_handler.py:114)
00:12:07.554 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (268286:async_checkpointer.py:87)
00:12:07.558 [I] Read Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1764921805806846962, 'commit_timestamp_nsecs': None, 'custom_metadata': {}} from /mnt/ssd1/yuxin/openpi/checkpoints/pi05_h1_auto/e2e_lift_lid/epoch_0/299.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (268286:checkpoint.py:226)
00:12:07.563 [I] Renaming /mnt/ssd1/yuxin/openpi/checkpoints/pi05_h1_auto/e2e_lift_lid/epoch_0/299.orbax-checkpoint-tmp-0/assets.orbax-checkpoint-tmp-1 to /mnt/ssd1/yuxin/openpi/checkpoints/pi05_h1_auto/e2e_lift_lid/epoch_0/299.orbax-checkpoint-tmp-0/assets (268286:atomicity.py:289)
00:12:07.565 [I] Updated Metadata={'item_handlers': {'assets': 'openpi.training.checkpoints.CallbackHandler', 'params': 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler', 'train_state': 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler'}, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1764921805806846962, 'commit_timestamp_nsecs': None, 'custom_metadata': {}} to /mnt/ssd1/yuxin/openpi/checkpoints/pi05_h1_auto/e2e_lift_lid/epoch_0/299.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (268286:checkpoint.py:245)
00:12:07.583 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (268286:array_metadata_store.py:362)
00:12:07.597 [I] Renaming /mnt/ssd1/yuxin/openpi/checkpoints/pi05_h1_auto/e2e_lift_lid/epoch_0/299.orbax-checkpoint-tmp-0/train_state.orbax-checkpoint-tmp-3 to /mnt/ssd1/yuxin/openpi/checkpoints/pi05_h1_auto/e2e_lift_lid/epoch_0/299.orbax-checkpoint-tmp-0/train_state (268286:atomicity.py:289)
00:12:07.600 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (268286:array_metadata_store.py:362)
00:12:07.604 [I] Renaming /mnt/ssd1/yuxin/openpi/checkpoints/pi05_h1_auto/e2e_lift_lid/epoch_0/299.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2 to /mnt/ssd1/yuxin/openpi/checkpoints/pi05_h1_auto/e2e_lift_lid/epoch_0/299.orbax-checkpoint-tmp-0/params (268286:atomicity.py:289)
00:12:07.605 [I] Renaming /mnt/ssd1/yuxin/openpi/checkpoints/pi05_h1_auto/e2e_lift_lid/epoch_0/299.orbax-checkpoint-tmp-0 to /mnt/ssd1/yuxin/openpi/checkpoints/pi05_h1_auto/e2e_lift_lid/epoch_0/299 (268286:atomicity.py:289)
00:12:07.606 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/mnt/ssd1/yuxin/openpi/checkpoints/pi05_h1_auto/e2e_lift_lid/epoch_0/299`. (268286:atomicity.py:573)
00:12:07.606 [I] Finished asynchronous save (blocking + background) in 521.81 seconds to /mnt/ssd1/yuxin/openpi/checkpoints/pi05_h1_auto/e2e_lift_lid/epoch_0/299 (268286:async_checkpointer.py:412)
00:12:07.607 [I] [process=0][thread=async_save] Background save thread done.                      (268286:async_checkpointer.py:143)
00:12:07.609 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (268286:async_checkpointer.py:266)
00:12:07.609 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (268286:async_checkpointer.py:276)
00:12:07.611 [I] [process=0][thread=save_finalize][step=299] CheckpointManager Save Finalize is syncing with other hosts... (268286:checkpoint_manager.py:2095)
00:12:07.611 [I] [process=0][thread=save_finalize][step=299] CheckpointManager Save Finalize is done on all hosts. (268286:checkpoint_manager.py:2110)
00:12:07.612 [I] [process=0][thread=MainThread][step=299][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=299. (268286:checkpoint_manager.py:2010)
wandb: 
wandb: ðŸš€ View run e2e_lift_lid/epoch_0 at: https://wandb.ai/yuxinchen/openpi/runs/6d17ntbl
wandb: Find logs at: wandb/run-20251204_234521-6d17ntbl/logs

========================================================
  > Training complete!
========================================================
Checkpoint saved to: checkpoints/pi05_h1_auto/e2e_lift_lid/epoch_0/train_state/
========================================================
[INFO] Training complete. Checkpoint: /home/yuxin/Projects/openpi/checkpoints/pi05_h1_auto/e2e_lift_lid/epoch_0/train_state/
[INFO] State saved: epoch=0, status=epoch_complete

========================================================
  EPOCH 1
========================================================
[INFO] State saved: epoch=1, status=collecting_data

========================================================
  Starting Policy Server
========================================================
[INFO] Checkpoint: /home/yuxin/Projects/openpi/checkpoints/pi05_h1_auto/e2e_lift_lid/epoch_0/train_state/
[INFO] Data dir: /home/yuxin/Projects/openpi/examples/h1_control_client/h1_data_lerobot/e2e_lift_lid/epoch_0
[INFO] Port: 8000
[INFO] Starting server...
[INFO] Server started with PID 273081
[INFO] Log: /home/yuxin/Projects/openpi/logs/server_epoch1.log
[INFO] Waiting for server to be ready...
  Waiting... 8/120s[ERROR] Server process died. Check logs: /home/yuxin/Projects/openpi/logs/server_epoch1.log
    return _policy_config.create_trained_policy(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yuxin/Projects/openpi/src/openpi/policies/policy_config.py", line 57, in create_trained_policy
    model = train_config.model.load(_model.restore_params(checkpoint_dir / "params", dtype=jnp.bfloat16))
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yuxin/Projects/openpi/src/openpi/models/model.py", line 314, in restore_params
    metadata = ckptr.metadata(params_path)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yuxin/Projects/openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/checkpointers/checkpointer.py", line 324, in metadata
    return self._handler.metadata(directory)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yuxin/Projects/openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/handlers/pytree_checkpoint_handler.py", line 1025, in metadata
    return self._handler_impl.metadata(directory)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yuxin/Projects/openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/handlers/base_pytree_checkpoint_handler.py", line 969, in metadata
    internal_tree_metadata = self._read_metadata_file(directory)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yuxin/Projects/openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/handlers/base_pytree_checkpoint_handler.py", line 926, in _read_metadata_file
    raise FileNotFoundError(
FileNotFoundError: Metadata file (named _METADATA) does not exist at /mnt/ssd1/yuxin/openpi/checkpoints/pi05_h1_auto/e2e_lift_lid/epoch_0/train_state/params.
[ERROR] Failed to start server

[INFO] Cleaning up...
[INFO] State saved: epoch=1, status=interrupted
[INFO] Cleanup complete.